nginx:
  image: nginx:1.10.1
  restart: always
  ports:
    - "51080:80"
    - "51443:443"
  links:
    - bitbucket
    - jira
    - confluence
    - crowd
    - bamboo
  environment:
     - CUSTOM_NGINX_HOST=foobar.com
     - CUSTOM_NGINX_PORT=80
  volumes:
   - ./nginx.conf.template:/etc/nginx/conf.d/nginx.conf.template
  command: /bin/bash -c "envsubst '$$CUSTOM_NGINX_HOST $$CUSTOM_NGINX_PORT' < /etc/nginx/conf.d/nginx.conf.template > /etc/nginx/conf.d/default.conf && nginx -g 'daemon off;'"

bitbucket:
  image: frootdock/atlassian-bitbucket
  restart: always
  links:
    - database
  volumes:
    - /opt/bitbucket-home

jira:
  image: frootdock/atlassian-jira
  restart: always
  links:
    - database
  volumes:
    - /opt/jira-home

confluence:
  image: frootdock/atlassian-confluence
  restart: always
  links:
    - database
  volumes:
    - /opt/confluence-home

crowd:
  image: frootdock/atlassian-crowd
  restart: always
  links:
    - database
  volumes:
    - /opt/crowd-home

bamboo:
  image: frootdock/atlassian-bamboo
  restart: always
  links:
    - database
  volumes:
    - /opt/bamboo-home

database:
  image: frootdock/atlassian-database
  restart: always
  volumes:
    - /var/lib/postgresql/data
    - /tmp/dumps # import backups
